---
// ============================================
// SECCIÓN 1: CONFIGURACIÓN (OBLIGATORIO)
// ============================================
// Define el color de fondo para este componente
export const showcaseConfig = {
  backgroundColor: '#f5f5f7', // Fondo claro estilo Apple
};
---

<!-- ============================================ -->
<!-- SECCIÓN 2: HTML DEL COMPONENTE (OBLIGATORIO) -->
<!-- ============================================ -->
<div class="dropdownMenu-container">
  <div class="dropdownMenu-centerWrapper">
    
    <!-- Main Dropdown Trigger -->
    <button class="dropdownMenu-trigger" id="mainTrigger">
      <span class="dropdownMenu-label">Menu</span>
      <svg class="dropdownMenu-chevron" width="12" height="12" viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M3 4.5l3 3 3-3"/>
      </svg>
    </button>

    <!-- Main Dropdown Content -->
    <div class="dropdownMenu-content" id="mainDropdown">
      
      <!-- Item 1: With Submenu (File Operations) -->
      <div class="dropdownMenu-item hasSubmenu" data-submenu="submenu1">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M13 2H6L3 5v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z"/>
          <path d="M3 5h3V2"/>
        </svg>
        <span>File Operations</span>
        <svg class="dropdownMenu-arrow" width="10" height="10" viewBox="0 0 10 10" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 2l3 3-3 3"/>
        </svg>
      </div>

      <!-- Submenu 1: File Operations -->
      <div class="dropdownMenu-submenu" id="submenu1">
        <div class="dropdownMenu-item" data-value="new">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M8 3v10M3 8h10"/>
          </svg>
          <span>New File</span>
          <span class="dropdownMenu-shortcut">⌘N</span>
        </div>
        <div class="dropdownMenu-item" data-value="open">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M13 2H6L3 5v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z"/>
            <path d="M3 5h3V2"/>
          </svg>
          <span>Open</span>
          <span class="dropdownMenu-shortcut">⌘O</span>
        </div>
        <div class="dropdownMenu-divider"></div>
        <div class="dropdownMenu-item" data-value="save">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M12 14H4a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h7l3 3v8a1 1 0 0 1-1 1z"/>
            <path d="M5 2v4h6V2M10 14v-4H6v4"/>
          </svg>
          <span>Save</span>
          <span class="dropdownMenu-shortcut">⌘S</span>
        </div>
      </div>

      <!-- Item 2: With Submenu (Edit Options) -->
      <div class="dropdownMenu-item hasSubmenu" data-submenu="submenu2">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M11.5 2.5l2 2L6 12H4v-2l7.5-7.5z"/>
          <path d="M9.5 4.5l2 2"/>
        </svg>
        <span>Edit Options</span>
        <svg class="dropdownMenu-arrow" width="10" height="10" viewBox="0 0 10 10" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 2l3 3-3 3"/>
        </svg>
      </div>

      <!-- Submenu 2: Edit Options -->
      <div class="dropdownMenu-submenu" id="submenu2">
        <div class="dropdownMenu-item" data-value="cut">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
            <circle cx="5" cy="5" r="2"/>
            <circle cx="5" cy="11" r="2"/>
            <path d="M13 3L7 8M13 13L7 8"/>
          </svg>
          <span>Cut</span>
          <span class="dropdownMenu-shortcut">⌘X</span>
        </div>
        <div class="dropdownMenu-item" data-value="copy">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="5" y="5" width="9" height="9" rx="1.5"/>
            <path d="M3 11V3a2 2 0 0 1 2-2h8"/>
          </svg>
          <span>Copy</span>
          <span class="dropdownMenu-shortcut">⌘C</span>
        </div>
        <div class="dropdownMenu-item" data-value="paste">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M10 2h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h2"/>
            <rect x="6" y="1" width="4" height="3" rx="1"/>
          </svg>
          <span>Paste</span>
          <span class="dropdownMenu-shortcut">⌘V</span>
        </div>
      </div>

      <!-- Item 3: With Submenu (View Settings) -->
      <div class="dropdownMenu-item hasSubmenu" data-submenu="submenu3">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M1 8s2.5-5 7-5 7 5 7 5-2.5 5-7 5-7-5-7-5z"/>
          <circle cx="8" cy="8" r="2"/>
        </svg>
        <span>View Settings</span>
        <svg class="dropdownMenu-arrow" width="10" height="10" viewBox="0 0 10 10" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 2l3 3-3 3"/>
        </svg>
      </div>

      <!-- Submenu 3: View Settings -->
      <div class="dropdownMenu-submenu" id="submenu3">
        <div class="dropdownMenu-item checkable active" data-value="sidebar">
          <svg class="dropdownMenu-check" width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M2 7l4 4 6-8"/>
          </svg>
          <span>Show Sidebar</span>
        </div>
        <div class="dropdownMenu-item checkable" data-value="toolbar">
          <svg class="dropdownMenu-check" width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M2 7l4 4 6-8"/>
          </svg>
          <span>Show Toolbar</span>
        </div>
        <div class="dropdownMenu-item checkable active" data-value="minimap">
          <svg class="dropdownMenu-check" width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M2 7l4 4 6-8"/>
          </svg>
          <span>Show Minimap</span>
        </div>
      </div>

      <div class="dropdownMenu-divider"></div>

      <!-- Item 4: With Submenu (Themes) -->
      <div class="dropdownMenu-item hasSubmenu" data-submenu="submenu4">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
          <circle cx="8" cy="8" r="6"/>
          <path d="M8 2v12M2 8h12"/>
        </svg>
        <span>Choose Theme</span>
        <svg class="dropdownMenu-arrow" width="10" height="10" viewBox="0 0 10 10" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 2l3 3-3 3"/>
        </svg>
      </div>

      <!-- Submenu 4: Themes -->
      <div class="dropdownMenu-submenu" id="submenu4">
        <div class="dropdownMenu-item color" data-value="purple">
          <div class="dropdownMenu-colorDot" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
          <span>Purple Dream</span>
        </div>
        <div class="dropdownMenu-item color" data-value="ocean">
          <div class="dropdownMenu-colorDot" style="background: linear-gradient(135deg, #0093E9 0%, #80D0C7 100%);"></div>
          <span>Ocean Breeze</span>
        </div>
        <div class="dropdownMenu-item color" data-value="sunset">
          <div class="dropdownMenu-colorDot" style="background: linear-gradient(135deg, #FF6B6B 0%, #FFE66D 100%);"></div>
          <span>Sunset Glow</span>
        </div>
        <div class="dropdownMenu-item color" data-value="forest">
          <div class="dropdownMenu-colorDot" style="background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%);"></div>
          <span>Forest Green</span>
        </div>
      </div>

      <div class="dropdownMenu-divider"></div>

      <!-- Item 5: With Submenu (Account) -->
      <div class="dropdownMenu-item hasSubmenu" data-submenu="submenu5">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
          <circle cx="8" cy="6" r="3"/>
          <path d="M2 14c0-3.3 2.7-6 6-6s6 2.7 6 6"/>
        </svg>
        <span>Account</span>
        <svg class="dropdownMenu-arrow" width="10" height="10" viewBox="0 0 10 10" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 2l3 3-3 3"/>
        </svg>
      </div>

      <!-- Submenu 5: Account -->
      <div class="dropdownMenu-submenu wide" id="submenu5">
        <div class="dropdownMenu-profile">
          <div class="dropdownMenu-profileAvatar">
            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="16" cy="12" r="5"/>
              <path d="M6 28c0-5.5 4.5-10 10-10s10 4.5 10 10"/>
            </svg>
          </div>
          <div class="dropdownMenu-profileInfo">
            <div class="dropdownMenu-profileName">John Appleseed</div>
            <div class="dropdownMenu-profileEmail">john@apple.com</div>
          </div>
        </div>
        <div class="dropdownMenu-divider"></div>
        <div class="dropdownMenu-item" data-value="profile">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
            <circle cx="8" cy="6" r="3"/>
            <path d="M2 14c0-3.3 2.7-6 6-6s6 2.7 6 6"/>
          </svg>
          <span>My Profile</span>
        </div>
        <div class="dropdownMenu-item" data-value="settings">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
            <circle cx="8" cy="8" r="3"/>
            <path d="M8 1v2M8 13v2M15 8h-2M3 8H1M13.5 13.5l-1.4-1.4M3.9 3.9L2.5 2.5M13.5 2.5L12.1 3.9M3.9 12.1l-1.4 1.4"/>
          </svg>
          <span>Settings</span>
        </div>
        <div class="dropdownMenu-divider"></div>
        <div class="dropdownMenu-item destructive" data-value="logout">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M6 14H3a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h3M11 11l3-3-3-3M14 8H6"/>
          </svg>
          <span>Sign Out</span>
        </div>
      </div>

      <div class="dropdownMenu-divider"></div>

      <!-- Simple item without submenu -->
      <div class="dropdownMenu-item" data-value="help">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
          <circle cx="8" cy="8" r="6"/>
          <path d="M6 6.5c0-1.1.9-2 2-2s2 .9 2 2c0 1-1 1.5-2 2v1"/>
          <circle cx="8" cy="12" r="0.5" fill="currentColor"/>
        </svg>
        <span>Help</span>
      </div>

    </div>

  </div>
</div>

<!-- ============================================ -->
<!-- SECCIÓN 3: ESTILOS CSS (OBLIGATORIO) -->
<!-- ============================================ -->
<style>
  .dropdownMenu-container {
    width: 100%;
    max-width: 100%;
    position: relative;
    min-height: 500px;
    display: flex;
    align-items: flex-start;
    justify-content: center;
    padding-top: 60px;
  }

  .dropdownMenu-centerWrapper {
    position: relative;
  }

  /* Trigger Button */
  .dropdownMenu-trigger {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 20px;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(0, 0, 0, 0.06);
    border-radius: 10px;
    font-size: 15px;
    font-weight: 500;
    color: #1d1d1f;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
    box-shadow: 
      0 1px 2px rgba(0, 0, 0, 0.04),
      0 2px 8px rgba(0, 0, 0, 0.02),
      inset 0 0.5px 0.5px rgba(255, 255, 255, 0.8);
    min-width: 180px;
    justify-content: space-between;
  }

  .dropdownMenu-trigger:hover {
    background: rgba(255, 255, 255, 0.95);
    border-color: rgba(0, 0, 0, 0.1);
    box-shadow: 
      0 2px 4px rgba(0, 0, 0, 0.06),
      0 4px 12px rgba(0, 0, 0, 0.04),
      inset 0 0.5px 0.5px rgba(255, 255, 255, 0.9);
    transform: translateY(-1px);
  }

  .dropdownMenu-trigger:active {
    transform: scale(0.98);
    box-shadow: 
      0 1px 2px rgba(0, 0, 0, 0.04),
      inset 0 1px 2px rgba(0, 0, 0, 0.06);
  }

  .dropdownMenu-trigger.active {
    background: rgba(255, 255, 255, 1);
    border-color: rgba(0, 122, 255, 0.3);
    box-shadow: 
      0 0 0 3px rgba(0, 122, 255, 0.1),
      0 2px 8px rgba(0, 0, 0, 0.08);
  }

  .dropdownMenu-trigger.active .dropdownMenu-chevron {
    transform: rotate(180deg);
  }

  .dropdownMenu-label {
    flex: 1;
    text-align: left;
  }

  .dropdownMenu-chevron {
    flex-shrink: 0;
    transition: transform 0.35s cubic-bezier(0.4, 0.0, 0.2, 1);
    opacity: 0.5;
  }

  /* Dropdown Content */
  .dropdownMenu-content {
    position: absolute;
    top: calc(100% + 8px);
    left: 0;
    min-width: 100%;
    width: max-content;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(40px) saturate(180%);
    -webkit-backdrop-filter: blur(40px) saturate(180%);
    border: 1px solid rgba(0, 0, 0, 0.08);
    border-radius: 12px;
    padding: 6px;
    box-shadow: 
      0 4px 6px rgba(0, 0, 0, 0.05),
      0 10px 20px rgba(0, 0, 0, 0.08),
      0 20px 40px rgba(0, 0, 0, 0.06),
      inset 0 0.5px 0.5px rgba(255, 255, 255, 0.9);
    opacity: 0;
    visibility: hidden;
    transform: translateY(-8px) scale(0.96);
    transform-origin: top center;
    transition: 
      opacity 0.25s cubic-bezier(0.4, 0.0, 0.2, 1),
      transform 0.35s cubic-bezier(0.175, 0.885, 0.32, 1.275),
      visibility 0.25s;
    z-index: 1000;
    pointer-events: none;
  }

  .dropdownMenu-content.active {
    opacity: 1;
    visibility: visible;
    transform: translateY(0) scale(1);
    pointer-events: auto;
  }

  /* Submenu */
  .dropdownMenu-submenu {
    position: absolute;
    left: calc(100% + 4px);
    top: -6px;
    min-width: 200px;
    width: max-content;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(40px) saturate(180%);
    -webkit-backdrop-filter: blur(40px) saturate(180%);
    border: 1px solid rgba(0, 0, 0, 0.08);
    border-radius: 12px;
    padding: 6px;
    box-shadow: 
      0 4px 6px rgba(0, 0, 0, 0.05),
      0 10px 20px rgba(0, 0, 0, 0.08),
      0 20px 40px rgba(0, 0, 0, 0.06),
      inset 0 0.5px 0.5px rgba(255, 255, 255, 0.9);
    opacity: 0;
    visibility: hidden;
    transform: translateX(-8px) scale(0.96);
    transform-origin: left center;
    transition: 
      opacity 0.2s cubic-bezier(0.4, 0.0, 0.2, 1),
      transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275),
      visibility 0.2s;
    z-index: 1001;
    pointer-events: none;
  }

  .dropdownMenu-submenu.wide {
    min-width: 260px;
  }

  .dropdownMenu-submenu.active {
    opacity: 1;
    visibility: visible;
    transform: translateX(0) scale(1);
    pointer-events: auto;
  }

  /* Dropdown Items */
  .dropdownMenu-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 10px;
    border-radius: 7px;
    font-size: 14px;
    color: #1d1d1f;
    cursor: pointer;
    transition: all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
    position: relative;
    user-select: none;
  }

  .dropdownMenu-item svg {
    flex-shrink: 0;
    opacity: 0.7;
    transition: opacity 0.2s ease;
  }

  .dropdownMenu-item span {
    flex: 1;
  }

  .dropdownMenu-item:hover {
    background: rgba(0, 122, 255, 0.08);
    color: #007aff;
  }

  .dropdownMenu-item:hover svg {
    opacity: 1;
    stroke: #007aff;
  }

  .dropdownMenu-item:active {
    transform: scale(0.97);
    background: rgba(0, 122, 255, 0.12);
  }

  /* Items with submenu */
  .dropdownMenu-item.hasSubmenu {
    padding-right: 26px;
  }

  .dropdownMenu-arrow {
    position: absolute;
    right: 8px;
    opacity: 0.4;
    transition: all 0.2s ease;
  }

  .dropdownMenu-item.hasSubmenu:hover .dropdownMenu-arrow {
    opacity: 1;
    transform: translateX(2px);
  }

  /* Destructive Items */
  .dropdownMenu-item.destructive:hover {
    background: rgba(255, 59, 48, 0.08);
    color: #ff3b30;
  }

  .dropdownMenu-item.destructive:hover svg {
    stroke: #ff3b30;
  }

  .dropdownMenu-item.destructive:active {
    background: rgba(255, 59, 48, 0.12);
  }

  /* Checkable Items */
  .dropdownMenu-item.checkable {
    padding-left: 32px;
  }

  .dropdownMenu-check {
    position: absolute;
    left: 8px;
    opacity: 0;
    transform: scale(0.8);
    transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    stroke: #007aff;
  }

  .dropdownMenu-item.checkable.active .dropdownMenu-check {
    opacity: 1;
    transform: scale(1);
  }

  /* Color Items */
  .dropdownMenu-colorDot {
    width: 20px;
    height: 20px;
    border-radius: 6px;
    flex-shrink: 0;
    box-shadow: 
      0 1px 3px rgba(0, 0, 0, 0.15),
      inset 0 0.5px 0.5px rgba(255, 255, 255, 0.3);
  }

  /* Shortcuts */
  .dropdownMenu-shortcut {
    font-size: 12px;
    opacity: 0.5;
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
    letter-spacing: 0.3px;
  }

  /* Divider */
  .dropdownMenu-divider {
    height: 1px;
    background: rgba(0, 0, 0, 0.06);
    margin: 6px 0;
  }

  /* Profile Section */
  .dropdownMenu-profile {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 10px;
  }

  .dropdownMenu-profileAvatar {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
  }

  .dropdownMenu-profileAvatar svg {
    stroke: white;
  }

  .dropdownMenu-profileInfo {
    flex: 1;
    min-width: 0;
  }

  .dropdownMenu-profileName {
    font-size: 15px;
    font-weight: 600;
    color: #1d1d1f;
    margin-bottom: 2px;
  }

  .dropdownMenu-profileEmail {
    font-size: 13px;
    color: #86868b;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .dropdownMenu-container {
      min-height: 650px;
      padding-top: 40px;
    }

    .dropdownMenu-submenu {
      left: auto;
      right: auto;
      top: calc(100% + 4px);
      transform: translateY(-8px) scale(0.96);
    }

    .dropdownMenu-submenu.active {
      transform: translateY(0) scale(1);
    }
  }

  @media (max-width: 480px) {
    .dropdownMenu-container {
      min-height: 750px;
      padding-top: 40px;
    }
  }
</style>

<!-- ============================================ -->
<!-- SECCIÓN 4: JAVASCRIPT (OBLIGATORIO) -->
<!-- ============================================ -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const mainTrigger = document.getElementById('mainTrigger');
    const mainDropdown = document.getElementById('mainDropdown');
    const itemsWithSubmenu = document.querySelectorAll('.dropdownMenu-item.hasSubmenu');
    let activeSubmenu: HTMLElement | null = null;
    let submenuTimeout: number;

    // Toggle main dropdown
    mainTrigger?.addEventListener('click', (e) => {
      e.stopPropagation();
      const isActive = mainDropdown?.classList.contains('active');
      
      if (isActive) {
        mainDropdown?.classList.remove('active');
        mainTrigger?.classList.remove('active');
        // Cerrar cualquier submenu abierto
        if (activeSubmenu) {
          activeSubmenu.classList.remove('active');
          activeSubmenu = null;
        }
      } else {
        mainDropdown?.classList.add('active');
        mainTrigger?.classList.add('active');
      }
    });

    // Manejar items con submenu
    itemsWithSubmenu.forEach((item) => {
      const submenuId = item.getAttribute('data-submenu');
      const submenu = document.getElementById(submenuId || '');

      if (!submenu) return;

      // Hover para mostrar submenu
      item.addEventListener('mouseenter', () => {
        clearTimeout(submenuTimeout);
        
        // Cerrar submenu anterior
        if (activeSubmenu && activeSubmenu !== submenu) {
          activeSubmenu.classList.remove('active');
        }

        // Abrir nuevo submenu
        submenu.classList.add('active');
        activeSubmenu = submenu;
      });

      // Click en items del submenu
      const submenuItems = submenu.querySelectorAll('.dropdownMenu-item:not(.hasSubmenu)');
      submenuItems.forEach((subItem) => {
        subItem.addEventListener('click', (e) => {
          e.stopPropagation();
          
          // Manejar items checkables
          if (subItem.classList.contains('checkable')) {
            subItem.classList.toggle('active');
            return; // No cerrar el dropdown
          }

          // Cerrar todo después de la selección
          setTimeout(() => {
            mainDropdown?.classList.remove('active');
            mainTrigger?.classList.remove('active');
            submenu.classList.remove('active');
            activeSubmenu = null;
          }, 150);
        });
      });
    });

    // Cerrar submenu al salir del área
    mainDropdown?.addEventListener('mouseleave', () => {
      submenuTimeout = window.setTimeout(() => {
        if (activeSubmenu) {
          activeSubmenu.classList.remove('active');
          activeSubmenu = null;
        }
      }, 300);
    });

    // Mantener submenu abierto al entrar
    document.querySelectorAll('.dropdownMenu-submenu').forEach((submenu) => {
      submenu.addEventListener('mouseenter', () => {
        clearTimeout(submenuTimeout);
      });

      submenu.addEventListener('mouseleave', () => {
        submenuTimeout = window.setTimeout(() => {
          (submenu as HTMLElement).classList.remove('active');
          if (activeSubmenu === submenu) {
            activeSubmenu = null;
          }
        }, 200);
      });
    });

    // Click en items simples (sin submenu)
    const simpleItems = mainDropdown?.querySelectorAll('.dropdownMenu-item:not(.hasSubmenu)');
    simpleItems?.forEach((item) => {
      item.addEventListener('click', (e) => {
        e.stopPropagation();
        
        // Cerrar todo
        setTimeout(() => {
          mainDropdown?.classList.remove('active');
          mainTrigger?.classList.remove('active');
          if (activeSubmenu) {
            activeSubmenu.classList.remove('active');
            activeSubmenu = null;
          }
        }, 150);
      });
    });

    // Cerrar dropdown al hacer click fuera
    document.addEventListener('click', (e) => {
      const target = e.target as Node;
      if (mainDropdown && !mainDropdown.contains(target) && !mainTrigger?.contains(target)) {
        mainDropdown.classList.remove('active');
        mainTrigger?.classList.remove('active');
        if (activeSubmenu) {
          activeSubmenu.classList.remove('active');
          activeSubmenu = null;
        }
      }
    });

    // Cerrar con tecla Escape
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        mainDropdown?.classList.remove('active');
        mainTrigger?.classList.remove('active');
        if (activeSubmenu) {
          activeSubmenu.classList.remove('active');
          activeSubmenu = null;
        }
      }
    });
  });
</script>